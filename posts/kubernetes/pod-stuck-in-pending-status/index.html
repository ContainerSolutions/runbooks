<!doctype html><html><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-N2WWDBK5SV"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-N2WWDBK5SV')</script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Pod Stuck in Pending State &ndash; Runbooks</title><meta name=description property="og:description" content="Pod Stuck In Pending State|"><meta name=apple-mobile-web-app-title content="Runbooks"><link rel=stylesheet href=/runbooks/assets/syntax.css><link rel=stylesheet href=/runbooks/assets/primer-build.css><link rel=stylesheet href=/runbooks/assets/style.css><link rel=stylesheet href=https://containersolutions.github.io/runbooks/custom_style.899dd13784115b34654e51c818307a0a.css></head><body class=bg-gray><div id=holy class="container-lg bg-white h-100"><div id=header class="px-1 bg-white"><nav class="UnderlineNav UnderlineNav--right px-2"><a class="UnderlineNav-actions muted-link h2" href=https://containersolutions.github.io/runbooks/>Runbooks</a><div class="pseudo-menu-item text-gray"><div class=pseudo-flex-item><span class=pseudo-nav-item><a href=https://github.com/containersolutions/runbooks/edit/master/content/posts/kubernetes/pod-stuck-in-pending-status.md class=edit-link><svg aria-hidden="true" height="16" role="img" viewBox="0 0 14 16" width="14" class="pencil"><path fill-rule="evenodd" d="M0 12v3h3l8-8-3-3-8 8zm3 2H1v-2h1v1h1v1zm10.3-9.3L12 6 9 3l1.3-1.3a.996.996.0 011.41.0l1.59 1.59c.39.39.39 1.02.0 1.41z"/></svg>&nbsp;
Improve this page</a></span></div></div><div class=UnderlineNav-body><div class="flex-column position-relative dropdown"><span class=UnderlineNav-item>Nav Menu</span><div class="Box Box--condensed position-absolute dropdown-content"><div class=Box-body><a href=/runbooks/>Home</a></div><div class=Box-body><a href=/runbooks/posts/kubernetes/>Kubernetes</a></div><div class=Box-body><a href=/runbooks/posts/linux/>Linux</a></div><div class=Box-body><a href=/runbooks/posts/networking/>Networking</a></div><div class=Box-body><a href=/runbooks/posts/python/>Python</a></div><div class=Box-body><a href=/runbooks/posts/how-to/>How-Tos</a></div><div class=Box-body><a href=/runbooks/posts/golang/>Go</a></div></div></div></div></nav></div><div role=main id=main class="holy-main markdown-body px-4 bg-white"><div class=Subhead><div class=Subhead-heading><div class="h1 mt-3 mb-1">Pod Stuck in Pending State</div></div><div class=Subhead-description><div class=float-md-right><span title="Lastmod: 2023-01-26. Published at: 0001-01-01.">Lastmod: 2023-01-26</span></div></div></div><article><section class="pb-6 mb-3 border-bottom"><h2 id=overview>Overview</h2><p>A pod has been deployed, and remains in a Pending state for more time than is expected.</p><h2 id=check-runbook-match>Check RunBook Match</h2><p>When running a <code>kubectl get pods</code> command, you will see a line like this in the output for your pod:</p><pre><code>NAME                     READY     STATUS             RESTARTS   AGE
nginx-7ef9efa7cd-qasd2   0/1       Pending            0          1h
</code></pre><h2 id=initial-steps-overview>Initial Steps Overview</h2><ol><li><p><a href=#step-1>Gather information</a></p></li><li><p><a href=#step-2>Examine pod <code>Events</code> output</a></p></li><li><p><a href=#step-3>Check kubelet logs</a></p></li><li><p><a href=#step-4>Is this a coredns or kube-dns pods?</a></p></li><li><p><a href=#step-5>Check kubelet is running</a></p></li><li><p><a href=#step-6>Debug no nodes available</a></p></li><li><p><a href=#step-7>Debug <code>pulling image</code></a></p></li><li><p><a href=#step-8>Check component statuses</a></p></li></ol><h2 id=detailed-steps>Detailed Steps</h2><h3 id=step-1>1) Gather information</h3><p>To determine the root cause here, first gather relevant information that you may need to refer back to later:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl describe pod -n <span style=color:#f92672>[</span>NAMESPACE<span style=color:#f92672>]</span> -p <span style=color:#f92672>[</span>POD_NAME<span style=color:#f92672>]</span> &gt; /tmp/runbooks_describe_pod.txt
kubectl describe nodes &gt; /tmp/runbooks_describe_nodes.txt
kubectl get componentstatuses &gt; /tmp/runbooks_componentstatuses.txt
</code></pre></div><h3 id=2-examine-pod-events-output>2) Examine pod <code>Events</code> output.</h3><p>Look at the <code>Events</code> section of your <code>/tmp/runbooks_describe_pod.txt</code> file.</p><h4 id=21-if-the-last-message-is-pulling-image>2.1) If the last message is <code>pulling image</code></h4><p>then skip to <a href=#step-8>Debug <code>pulling image</code></a>.</p><h4 id=step-2-2>2.2) If you see a <code>FailedScheduling</code> warning with <code>Insufficient cpu</code> or <code>Insuffient memory</code></h4><p>mentioned, you have run out of resources available to run your pod:</p><pre><code>  Warning  FailedScheduling  40s (x98 over 2h)  default-scheduler  0/1 nodes are available: 1 Insufficient cpu (1).
</code></pre><pre><code>  Warning  FailedScheduling  40s (x98 over 2h)  default-scheduler  0/1 nodes are available: 1 Insufficient memory (1).
</code></pre><p>Go to <a href=#solution-b>Solution B</a></p><h4 id=23-if-you-see-a-failedscheduling--0n-nodes-are-available-warning>2.3) If you see a <code>FailedScheduling [...] 0/n nodes are available</code> warning</h4><p>mentioned, you have run out of nodes available to assign this pod to.</p><pre><code>  Warning  FailedScheduling  3m (x57 over 19m)  default-scheduler  0/1 nodes are available: 1 MatchNodeSelector.
</code></pre><p>Skip to <a href=#step-6>debug no nodes available</a>.</p><h4 id=24-if-you-see-a-cni-config-error-like-this>2.4) If you see a <code>cni config</code> error like this:</h4><pre><code>Container runtime network not ready: NetworkReady=false reason:NetworkPluginNotReady message:docker: network plugin is not ready: cni config uninitialized
</code></pre><p>then see <a href=#solution-c>Solution C</a></p><h4 id=25-if-you-see-pod-has-unbound-immediate-persistentvolumeclaims-warnings>2.5) If you see <code>pod has unbound immediate PersistentVolumeClaims</code> warnings</h4><p>like this:</p><pre><code>Warning  FailedScheduling  7s (x15 over 17m)  default-scheduler  running &quot;VolumeBinding&quot; filter plugin for pod &quot;podname-rh-0&quot;: pod has unbound immediate PersistentVolumeClaims
</code></pre><p>then consider:</p><ul><li>have you bound the same PersistentVolume to multiple pods (eg in a stateful set) and that these volumes can&rsquo;t be concurrently bound to multiple pods?</li></ul><p>accessModes need to be <code>ReadWriteMany</code> if you want to have multiple pods access them.</p><p>See also <a href=https://groups.google.com/forum/#!topic/kubernetes-users/6A1ZwSYkG8I>here</a> for more background on this.</p><ul><li>does the specified PersistentVolumeClaim exist?</li></ul><p>TODO: separate 2.5 out into its own runbook and reference from here. cf: <a href=https://github.com/hashicorp/consul-helm/issues/237#issuecomment-573463910>1</a></p><h3 id=step-3>3) Check the kubelet logs</h3><p>If your pod has been assigned to a node, and you have admin access to that node, then it may be worth checking the kubelet logs for errors on that node.</p><p>Otherwise, you can run:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl get nodes -o wide <span style=color:#f92672>[</span>NODE_NAME<span style=color:#f92672>]</span>
</code></pre></div><p>to check on the status of that node. If it does not appear ready, then run:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>kubectl describe nodes <span style=color:#f92672>[</span>NODE_NAME<span style=color:#f92672>]</span>
</code></pre></div><h3 id=step-4>4) Is this a <code>coredns</code> or <code>kube-dns</code> pod?</h3><p>If so, this may be intentional behaviour. See <a href=https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/troubleshooting-kubeadm/#coredns-or-kube-dns-is-stuck-in-the-pending-state>here</a></p><h3 id=step-5>5) Check the kubelet is running</h3><p>If the kubelet is not running on the node the pod has been assigned to, this error may be seen.</p><p>You can check this in various ways that may be context-dependent, eg:</p><ul><li><code>systemctl status [SERVICE_NAME]</code></li></ul><p>To determine the <code>SERVICE_NAME</code> above, you may want to run <code>systemctl --type service | grep kube</code> to determine the service name.</p><p>If the kubelet is not running, go to <a href=#solution-a>restart kubelet</a></p><ul><li><code>ps -ef | grep kubelet</code></li></ul><h3 id=step-6>6) Debug no nodes available</h3><p>This might be caused by:</p><ul><li>pod demanding a particular node label</li></ul><p>See <a href=https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#node-isolationrestriction>here</a> for more on pod restrictions and examine <code>/tmp/runbooks_describe_pod.txt</code> to see whether the pod has any nodeSelectors set, and if so, whether any available nodes match these nodes.</p><ul><li>pod anti-affinity</li></ul><p>See <a href=https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#affinity-and-anti-affinity>here</a> for more on pod affinity and anti-affinity.</p><p>You may see more useful debug information in the original warning message in <code>/tmp/runbooks_describe_pod.txt</code>:</p><pre><code>Warning  FailedScheduling  &lt;unknown&gt;  default-scheduler  0/1 nodes are available: 1 node(s) had taint {node.kubernetes.io/disk-pressure: }, that the pod didn't tolerate.
</code></pre><ul><li>nodes being busy</li></ul><p>If your pod could not be scheduled because nodes were busy, then <a href=#step-2-2>this step</a> should have caught this.</p><h3 id=step-7>7) Debug <code>pulling image</code> event</h3><p>The first thing to consider is whether the download of the image needs more time.</p><p>If you think you have waited a sufficient amount of time, then it may be worth re-running the <code>describe pod</code> command from <a href=#step-1>step 1</a> to see if any message has followed it.</p><p>If there is still no output, and you have admin access, you may want to log onto the node the pod has been assigned to and run the appropriate pull command (eg <code>docker pull [IMAGE_NAME]</code>) on the image to see if the image is downloadable from the node.</p><h3 id=step-8>8) Check component statuses</h3><p>Examine the output of your <code>/tmp/runbooks_componentstatuses.txt</code> file, looking for unhealthy components.</p><p>This is most commonly a problem when a cluster has just been stood up.</p><h2 id=solutions-list>Solutions List</h2><p>A) <a href=#solution-a>Restart kubelet</a></p><p>B) <a href=#solution-b>Allocate resources</a></p><p>C) <a href=#solution-c>Repair your CNI</a></p><h2 id=solutions-detail>Solutions Detail</h2><h3 id=solution-a>A) Restart kubelet</h3><p>How exactly to restart the kubelet will depend on its process supervisor. The most common one is <code>systemctl</code>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>systemctl restart <span style=color:#f92672>[</span>SERVICE_NAME<span style=color:#f92672>]</span>
</code></pre></div><p>If you don&rsquo;t know how to restart the kubelet, you may need to contact your system administrator.</p><h3 id=solution-b>B) Allocate resources</h3><p>Determine whether you need to increase the resources available, or limit resources your pod requests so as not to breach the limits.
Which is appropriate depends on your particular circumstances.
See <a href=/runbooks/posts/kubernetes/0-nodes-available-insufficient/>the &ldquo;0 nodes available&rdquo; runbook</a> for further guidance.</p><h3 id=solution-c>C) Repair your CNI</h3><p>These links may help you resolve this problem:</p><p><a href=https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/#pod-network>Install the CNI provider</a></p><p>More rarely, this has been suggested as a solution:</p><p><code>Check if docker and kubernetes are using the same cgroup driver. I faced the same issue (CentOS 7, kubernetes v1.14.1), and setting same cgroup driver (systemd) fixed it.</code> <a href=https://stackoverflow.com/questions/52609257/coredns-in-pending-state-in-kubernetes-cluster>Source</a></p><h2 id=check-resolution>Check Resolution</h2><p>If the pod starts up with status <code>RUNNING</code> according to the output of <code>kubectl get pods</code>, then the issue has been resolved.</p><p>If there is a different status, then it may be that this particular issue is resolved, but a new issue has been revealed.</p><p>If it has not been resolved by this runbook, then please comment below.</p><h2 id=further-steps>Further Steps</h2><p>None</p><h2 id=further-information>Further Information</h2><p>See <a href=https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/>here</a> for background information on pod placement.</p><p><a href=https://kubernetes.io/docs/tasks/debug-application-cluster/debug-cluster/#looking-at-logs>Kubelet logs</a></p><h2 id=owner>Owner</h2><p><a href=https://github.com/ianmiell>Ian Miell</a></p></section><section><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//runbooks.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></article></div><div id=side class="pr-1 bg-white"><aside class=pr-3><div id=toc class="Box Box--blue mb-3"><b>Pod Stuck in Pending State</b><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#check-runbook-match>Check RunBook Match</a></li><li><a href=#initial-steps-overview>Initial Steps Overview</a></li><li><a href=#detailed-steps>Detailed Steps</a><ul><li><a href=#step-1>1) Gather information</a></li><li><a href=#2-examine-pod-events-output>2) Examine pod <code>Events</code> output.</a></li><li><a href=#step-3>3) Check the kubelet logs</a></li><li><a href=#step-4>4) Is this a <code>coredns</code> or <code>kube-dns</code> pod?</a></li><li><a href=#step-5>5) Check the kubelet is running</a></li><li><a href=#step-6>6) Debug no nodes available</a></li><li><a href=#step-7>7) Debug <code>pulling image</code> event</a></li><li><a href=#step-8>8) Check component statuses</a></li></ul></li><li><a href=#solutions-list>Solutions List</a></li><li><a href=#solutions-detail>Solutions Detail</a><ul><li><a href=#solution-a>A) Restart kubelet</a></li><li><a href=#solution-b>B) Allocate resources</a></li><li><a href=#solution-c>C) Repair your CNI</a></li></ul></li><li><a href=#check-resolution>Check Resolution</a></li><li><a href=#further-steps>Further Steps</a></li><li><a href=#further-information>Further Information</a></li><li><a href=#owner>Owner</a></li></ul></nav></div><div></div></aside></div><div id=footer class="pt-2 pb-3 bg-white text-center"></div></div><div class="container-lg bg-white h-50">&nbsp;</div><div class=footer-container-wrapper><div class=footer-image><a href=https://container-solutions.com><img src=https://containersolutions.github.io/runbooks/images/logo-main.svg class=hs-image-widget style=width:120px;border-width:0;border:0 width=120 alt=logo-main title=logo-main></a></div><div>Runbooks is sponsored by <a href=https://container-solutions.com>Container Solutions</a>. We bring culture, strategy, and technology together<br>&mdash;to make sure your Cloud Native migration is done right. <a href=https://www.container-solutions.com>See how we can help</a></div></div><div class="bg-white h-10"><div class="text-small text-gray credits">Powered by the
<a href=https://github.com/qqhann/hugo-primer class=link-gray-dark>Hugo-Primer</a> theme for
<a href=https://gohugo.io class=link-gray-dark>Hugo</a>.</div></div></body></html>